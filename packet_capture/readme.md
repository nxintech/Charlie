# parse by hand
```
python sniffer.py

incoming src=100.100.25.3:80, dst=10.112.13.6:21077, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
incoming src=10.100.27.113:61913, dst=10.112.13.6:22, packet len= 40
```

use pacap lib, `pip install dpkt pypcap`

```
python pacp_sniffer.py

2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 228
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 180
2017-11-14 16:10:47 10.100.27.113:61913 -> 10.112.13.6:22 20
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 228
2017-11-14 16:10:47 10.100.27.113:61913 -> 10.112.13.6:22 20
2017-11-14 16:10:47 10.100.27.113:61913 -> 10.112.13.6:22 20
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 292
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 180
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 180
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 180
2017-11-14 16:10:47 10.100.27.113:61913 -> 10.112.13.6:22 20
2017-11-14 16:10:47 10.100.27.113:61913 -> 10.112.13.6:22 20
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 228
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 228
2017-11-14 16:10:47 10.112.13.6:22 -> 10.100.27.113:61913 180
```
# gopacket
pcap and af_packet version

af_packet require kernel version > 3.1
see https://github.com/google/gopacket/issues/149

install
```
go get github.com/google/gopacket
mkdir -p $GOPATH/src/golang.org/x
cd $GOPATH/src/golang.org/x
git clone https://github.com/golang/net.git
git clone https://github.com/golang/sys.git
```

run output
```
2017/11/14 17:33:00 new stream 10.211.254.26:80->10.112.13.8:28209 started
2017/11/14 17:33:00 10.112.13.8:28177->10.211.254.26:80 204
2017/11/14 17:33:00 10.112.13.8:28201->10.211.254.26:80 467
2017/11/14 17:33:00 10.211.254.26:80->10.112.13.8:28177 327
2017/11/14 17:33:00 10.211.254.26:80->10.112.13.8:28201 1091
2017/11/14 17:33:00 10.112.13.8:28183->10.211.254.26:80 204
2017/11/14 17:33:00 10.112.13.8:28203->10.211.254.26:80 467
2017/11/14 17:33:00 10.211.254.26:80->10.112.13.8:28183 327
2017/11/14 17:33:00 10.211.254.26:80->10.112.13.8:28203 1680
2017/11/14 17:33:00 new stream 10.112.13.8:20512->140.205.140.205:80 started
2017/11/14 17:33:00 10.112.13.8:28179->10.211.254.26:80 211
2017/11/14 17:33:00 10.112.13.8:28199->10.211.254.26:80 481
2017/11/14 17:33:00 10.211.254.26:80->10.112.13.8:28199 841
2017/11/14 17:33:00 10.211.254.26:80->10.112.13.8:28179 327
2017/11/14 17:33:01 10.112.13.8:28195->10.211.254.26:80 201
2017/11/14 17:33:01 10.112.13.8:28205->10.211.254.26:80 461
2017/11/14 17:33:01 10.211.254.26:80->10.112.13.8:28205 1502
2017/11/14 17:33:01 10.211.254.26:80->10.112.13.8:28195 327
2017/11/14 17:33:01 10.112.13.8:28197->10.211.254.26:80 204
2017/11/14 17:33:01 10.112.13.8:28207->10.211.254.26:80 467
```
# ref
http://elixir.free-electrons.com/linux/latest/source/Documentation/networking/packet_mmap.txt

https://blog.cloudflare.com/kernel-bypass/